<html lang="en"><head>
    <meta charset="UTF-8">
    <title></title>
<style id="system" type="text/css">*{margin:0;padding:0;}body {	font:13.34px helvetica,arial,freesans,clean,sans-serif;	color:black;	line-height:1.4em;	background-color: #F8F8F8;	padding: 0.7em;}p {	margin:1em 0;	line-height:1.5em;}table {	font-size:inherit;	font:100%;	margin:1em;}table th{border-bottom:1px solid #bbb;padding:.2em 1em;}table td{border-bottom:1px solid #ddd;padding:.2em 1em;}input[type=text],input[type=password],input[type=image],textarea{font:99% helvetica,arial,freesans,sans-serif;}select,option{padding:0 .25em;}optgroup{margin-top:.5em;}pre,code{font:12px Monaco,"Courier New","DejaVu Sans Mono","Bitstream Vera Sans Mono",monospace;}pre {	margin:1em 0;	font-size:12px;	background-color:#eee;	border:1px solid #ddd;	padding:5px;	line-height:1.5em;	color:#444;	overflow:auto;	-webkit-box-shadow:rgba(0,0,0,0.07) 0 1px 2px inset;	-webkit-border-radius:3px;	-moz-border-radius:3px;border-radius:3px;white-space: pre-wrap;word-wrap:break-word;}pre code {	padding:0;	font-size:12px;	background-color:#eee;	border:none;}code {	font-size:12px;	background-color:#f8f8ff;	color:#444;	padding:0 .2em;	border:1px solid #dedede;}img{border:0;max-width:100%;}abbr{border-bottom:none;}a{color:#4183c4;text-decoration:none;}a:hover{text-decoration:underline;}a code,a:link code,a:visited code{color:#4183c4;}h2,h3{margin:1em 0;}h1,h2,h3,h4,h5,h6{border:0;}h1{font-size:170%;border-top:4px solid #aaa;padding-top:.5em;margin-top:1.5em;}h1:first-child{margin-top:0;padding-top:.25em;border-top:none;}h2{font-size:150%;margin-top:1.5em;border-top:4px solid #e0e0e0;padding-top:.5em;}h3{margin-top:1em;}hr{border:1px solid #ddd;}ul{margin:1em 0 1em 2em;}ol{margin:1em 0 1em 2em;}ul li,ol li{margin-top:.5em;margin-bottom:.5em;}ul ul,ul ol,ol ol,ol ul{margin-top:0;margin-bottom:0;}blockquote{margin:1em 0;border-left:5px solid #ddd;padding-left:.6em;color:#555;}dt{font-weight:bold;margin-left:1em;}dd{margin-left:2em;margin-bottom:1em;}@media screen and (min-width: 768px) {    body {        width: 748px;        margin:10px auto;    }}</style><style id="custom" type="text/css"></style></head>
<body marginheight="0"><h1>CUMCMCoding 2017</h1>
<h2>一、运行说明</h2>
<ol>
<li>环境：<ul>
<li>macOS Sierra 10.12.5</li>
<li>Python 3.6.2</li>
<li>IPython 6.2.0 </li>
<li>Anaconda Navigator 1.6.4, spyder 3.2.3</li>
</ul>
</li>
<li>使用的第三方库：（请先使用pip install <name>安装）<ul>
<li>pydot (1.2.3)</li>
<li>matplotlib (2.0.2)</li>
<li>scikit-learn (0.19.0)</li>
<li>graphviz (0.8)</li>
<li>pydot (1.2.3)</li>
<li>xlrd (1.1.0)</li>
<li>xlwt (1.3.0)</li>
</ul>
</name></li>
<li>为确保程序读取数据无误，若使用命令行执行代码，请先确保进入当前目录。</li>
<li>graphviz可能需要使用brew安装，或其他办法解决路径问题。</li>
</ol>
<h2>二、py源程序文件说明</h2>
<ol>
<li>统一说明：<ul>
<li>程序内含有计时模块，因此程序运行完后会打印运行时间。</li>
<li>对于运行时间较长的程序已经在代码开头以注释方式写明大约运行时长。该时间受环境影响。</li>
</ul>
</li>
<li><strong><em>kNN求绝对和相对密度.py</em></strong><ul>
<li>用到<strong>原始信息.xlsx</strong>的数据，并会把结果在本目录下输出为一个<code>.xls</code>文件，该文件会含有两个sheet。</li>
<li><code>main()</code>函数中的oldOrNew为<strong><em>0</em></strong>则对<strong>已完成任务</strong>进行处理。oldOrNew为<strong><em>1</em></strong>则对<strong>新任务</strong>进行处理。因此运行前先自行修改。</li>
</ul>
</li>
<li><strong><em>决策树分类.py</em></strong><ul>
<li>用到<strong>用于决策树与回归的密度数据.xlsx</strong>的数据，并会把结果在本目录下输出一个中间文件和<code>DecideTree.pdf</code>文件，该文件是<strong>决策树的可视化</strong>。</li>
<li>决策树的默认最大深度（即不剪枝处理）。也可以设置最大深度，在<code>main()</code>函数中有相应注释可以修改。</li>
</ul>
</li>
<li><strong><em>多元线性回归.py</em></strong><ul>
<li>用到<strong>用于决策树与回归的密度数据.xlsx</strong>的数据。</li>
<li>结果输出回归系数，以及10折交叉验证的均方差和均方根差。</li>
</ul>
</li>
<li><strong><em>测试最佳价格方案.py</em></strong><ul>
<li>用到<strong>用于决策树与回归的密度数据.xlsx</strong>的数据。</li>
<li>测试方法分两种，一种是给出文件让程度读入并测试，一种是根据前题结果计算价格并测试。默认使用第二种，使用枚举方法获得最佳系数。</li>
<li>若只用文件数据测试，则文件格式和读入数据文件格式一致即可，并修改<code>main()</code>中相应注释的代码。</li>
</ul>
</li>
<li><strong><em>任务打包+价格修改+测试.py</em></strong><ul>
<li>用到<strong>第三问编程数据.xlsx</strong>或<strong>第四问编程数据.xlsx</strong>的数据。</li>
<li><code>main()</code>函数中的oldOrNew为<strong><em>0</em></strong>则对<strong>已完成任务</strong>进行处理。oldOrNew为<strong><em>1</em></strong>则对<strong>新任务</strong>进行处理，并分别导入不用的xlsx数据。因此运行前先自行修改。</li>
<li>对于oldOrNew=1时，若想查看任务不打包时的测试结果，怎在<code>main()</code>函数中注释<code>kNNUpdatePrice(bigTable, k, p/10)</code>即可。此时输出结果也为多个，但不受p值影响，因此是同一个结果。</li>
</ul>
</li>
</ol>
<h2>三、xlsx文件说明</h2>
<ol>
<li><strong><em>原始信息.xlsx</em></strong>是对附件1~3的精简处理，里面共对应三个sheet。</li>
<li><strong><em>用于决策树与回归的密度数据.xlsx</em></strong>是<strong>kNN求绝对和相对密度.py</strong>程序运行后数据整合的结果。</li>
<li><strong><em>用于决策树与回归的密度数据.xlsx</em></strong>用于生成决策树和多元线性回归，由2点文件整合而成。</li>
<li><strong><em>第三问编程数据.xlsx</em></strong>和<strong><em>第四问编程数据.xlsx</em></strong>也是由<strong>原始信息.xlsx</strong>和<strong>用于决策树与回归的密度数据.xlsx</strong>整合而成。</li>
</ol>
<blockquote>
<p>Wrote by Markdown.
Edit By <a href="http://mahua.jser.me">MaHua</a></p>
</blockquote>
</body></html>